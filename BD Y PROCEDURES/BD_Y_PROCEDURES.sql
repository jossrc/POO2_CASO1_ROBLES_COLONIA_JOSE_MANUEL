USE master
GO

IF EXISTS(SELECT * FROM sysdatabases WHERE name='BDTRANSITO2018_LF')
BEGIN
	ALTER DATABASE BDTRANSITO2018_LF
	SET SINGLE_USER WITH ROLLBACK IMMEDIATE
	DROP DATABASE BDTRANSITO2018_LF
END
GO

CREATE DATABASE BDTRANSITO2018_LF
COLLATE MODERN_SPANISH_CI_AI
GO

USE BDTRANSITO2018_LF
GO

SET LANGUAGE SPANISH
GO

CREATE TABLE PROPIETARIOS
(
	DNIPRO	CHAR(8) CONSTRAINT PKPROPIETARIOS PRIMARY KEY,
	NOMPRO	VARCHAR(50),
	DIRPRO	VARCHAR(60) DEFAULT 'Sin Direccion',
	ELIMINADO CHAR(2) DEFAULT 'No'
)
GO

INSERT INTO PROPIETARIOS VALUES('12345678','Acuña Osorio, Maria','','No')
INSERT INTO PROPIETARIOS VALUES('11223344','Avino Azaña, Britney','','No')
INSERT INTO PROPIETARIOS VALUES('12378421','Carpio Sanchez, Susana','','No')
INSERT INTO PROPIETARIOS VALUES('12213583','Alvarez Rojas, Mario','','No')
INSERT INTO PROPIETARIOS VALUES('11734342','Bezada Obando, Mirlo','','No')
INSERT INTO PROPIETARIOS VALUES('15382477','Cabello Nieto, Carlos','','No')
INSERT INTO PROPIETARIOS VALUES('12165558','Caycho Pino, Elizabeth','','No')
INSERT INTO PROPIETARIOS VALUES('14356718','Enciso Iglesias, Lorena','','No')
INSERT INTO PROPIETARIOS VALUES('13642561','Fernandez Porras, Bryan','','No')
INSERT INTO PROPIETARIOS VALUES('13427518','Romario Barrientos, Luis','','No')
GO
INSERT INTO PROPIETARIOS VALUES('18524720','Rojas Ramos, Jose Luis','','No')
INSERT INTO PROPIETARIOS VALUES('10529724','Paredes Gonzales, Eduardo','','No')
INSERT INTO PROPIETARIOS VALUES('11184707','Nurith Guillen, Lucia','','No')
INSERT INTO PROPIETARIOS VALUES('18042268','Vergara Lopez, Daniel','','No')
INSERT INTO PROPIETARIOS VALUES('18275920','Huachua Lopez, Ernestina','','No')
INSERT INTO PROPIETARIOS VALUES('15407158','Lopez Costas, Marlon','','No')
INSERT INTO PROPIETARIOS VALUES('12044470','Cardenas Caceres, Juana','','No')
INSERT INTO PROPIETARIOS VALUES('16613758','Leon Malpartida, Ana','','No')
INSERT INTO PROPIETARIOS VALUES('19642622','Gonzales Carrillo, Mauricio','','No')
INSERT INTO PROPIETARIOS VALUES('15821147','Alarcon Brendano, Luis','','No')
INSERT INTO PROPIETARIOS VALUES('12804394','Arteaga Huaman, Patricia','','No')
INSERT INTO PROPIETARIOS VALUES('12702074','Bustamente Ramirez, Eduardo','','No')
INSERT INTO PROPIETARIOS VALUES('10965428','Cespedes Urbano, Lucia','','No')
INSERT INTO PROPIETARIOS VALUES('11059825','Estrada Ponte, Lucy','','No')
INSERT INTO PROPIETARIOS VALUES('15201747','Guzman Cruz, Eder','','No')
INSERT INTO PROPIETARIOS VALUES('18488975','Ramos Perez, Erick','','No')
INSERT INTO PROPIETARIOS VALUES('18272940','Rivera Custodio, Juan','','No')
INSERT INTO PROPIETARIOS VALUES('13521101','Robalino Perez, Jhonny','','No')
INSERT INTO PROPIETARIOS VALUES('15562047','Santiago Trujillo, Homero','','No')
INSERT INTO PROPIETARIOS VALUES('17824385','Vilca Borcani, Isabel','','No')
INSERT INTO PROPIETARIOS VALUES('16259372','Cardenas Lopez, Marcos','','No')
GO
INSERT INTO PROPIETARIOS VALUES('12540049','Salazar Campomanes, Elizabeth','','No')
INSERT INTO PROPIETARIOS VALUES('18541073','Rosales Vilca, Rosario','','No')
INSERT INTO PROPIETARIOS VALUES('16870947','Jara Madrid, Cecilia','','No')
INSERT INTO PROPIETARIOS VALUES('15471705','Alva Borja, Roxana','','No')
INSERT INTO PROPIETARIOS VALUES('26970418','Rodriguez Ramos, Leticia','','No')
GO

CREATE TABLE VEHICULOS 
(
	NROPLA  char (6) NOT NULL CONSTRAINT PKVEHICULOS primary key ,
	DNIPRO  char(8) NULL REFERENCES PROPIETARIOS,
	COLOR   varchar (25) NULL,
	MODELO  varchar(20) NULL,
	AÑO	    int,
	ELIMINADO char(2) DEFAULT 'No'
) 
GO

INSERT INTO VEHICULOS VALUES ('V00001','12345678','ROJO','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00002','11223344','AZUL','HYUNDAI',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00003','12378421','ROJO','KIA',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00004','12213583','PLOMO','HYUNDAI',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00005','11734342','VERDE','TOYOTA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00006','15382477','AZUL','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00007','12165558','ROJO','HYUNDAI',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00008','14356718','ROJO','TOYOTA',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00009','13642561','ROJO','MITSUBISHI',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00010','13427518','ROJO','NISSAN',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00011','18524720','ROJO','TOYOTA',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00012','10529724','NEGRO','HYUNDAI',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00013','11184707','AZUL','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00014','18042268','NEGRO','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00015','15407158','NEGRO','HYUNDAI',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00016','18275920','AZUL','NISSAN',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00017','12044470','ROJO','NISSAN',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00018','16613758','AZUL','TOYOTA',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00019','19642622','NEGRO','MERCEDES BENZ',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00020','15821147','ROJO','BMW',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00021','12804394','ROJO','TOYOTA',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00022','12702074','ROJO','MITSUBISHI',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00023','10965428','AZUL','HYUNDAI',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00024','11059825','NEGRO','HONDA',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00025','15201747','NEGRO','HYUNDAI',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00026','18488975','AZUL','MERCEDES BENZ',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00027','18272940','ROJO','HONDA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00028','13521101','AZUL','TOYOTA',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00029','15562047','NEGRO','GREAT WALL',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00030','17824385','PLATA','GREAT WALL',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00031','16259372','VERDE','BMW',2013,'No')
go
INSERT INTO VEHICULOS VALUES ('V00032','10529724','BLANCO','HYUNDAI',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00033','11184707','AZUL','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00034','18042268','NEGRO','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00035','15407158','ROJO','HYUNDAI',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00036','12540049','AZUL','NISSAN',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00037','12044470','ROJO','NISSAN',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00038','16870947','NEGRO','TOYOTA',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00039','19642622','NEGRO','MERCEDES BENZ',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00040','18541073','PLATA','BMW',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00041','12804394','ROJO','TOYOTA',2014,'No')
GO
INSERT INTO VEHICULOS VALUES ('V00042','12540049','ROJO','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00043','18541073','AZUL','HYUNDAI',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00044','16870947','PLOMO','HYUNDAI',2013,'No')
INSERT INTO VEHICULOS VALUES ('V00045','15471705','VERDE','TOYOTA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00046','26970418','AZUL','KIA',2015,'No')
INSERT INTO VEHICULOS VALUES ('V00047','19642622','ROJO','HYUNDAI',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00048','14356718','ROJO','TOYOTA',2016,'No')
INSERT INTO VEHICULOS VALUES ('V00049','13642561','ROJO','MITSUBISHI',2014,'No')
INSERT INTO VEHICULOS VALUES ('V00050','26970418','ROJO','NISSAN',2013,'No')
GO

CREATE TABLE INFRACCIONES(
	CODINF   char (3) NOT NULL CONSTRAINT PKINFRACCIONES primary key ,
	DESINF   varchar (50) not NULL ,
	GRADO	 int not null,
	IMPORTE  numeric (8, 2) not NULL,
	ELIMINADO char(2) DEFAULT 'No'
) 
GO

INSERT INTO INFRACCIONES VALUES ('I01','Luz Roja',1, 350,'No')
INSERT INTO INFRACCIONES VALUES ('I02','Exceso de Velocidad',1, 300,'No')
INSERT INTO INFRACCIONES VALUES ('I03','Sin Brevete', 1, 280,'No')
INSERT INTO INFRACCIONES VALUES ('I04','Mal Estacionado', 2, 220,'No')
INSERT INTO INFRACCIONES VALUES ('I05','Estado Etilico', 1, 400,'No')
INSERT INTO INFRACCIONES VALUES ('I06','Contra el Tráfico', 2, 250,'No')
INSERT INTO INFRACCIONES VALUES ('I07','No Respeta Semáforos', 2, 240,'No')
INSERT INTO INFRACCIONES VALUES ('I08','Contaminacion Ambiental', 3,125,'No')
INSERT INTO INFRACCIONES VALUES ('I09','Sin Lentes', 2, 220,'No')
INSERT INTO INFRACCIONES VALUES ('I10','No Respeta las Señales', 3, 170,'No')
INSERT INTO INFRACCIONES VALUES ('I11','No contar con Herramientas', 3, 160,'No')
INSERT INTO INFRACCIONES VALUES ('I12','No Extintor contra Incendios', 3, 150,'No')
GO

CREATE TABLE POLICIAS
(
	CODPOL char(5) NOT NULL CONSTRAINT PKPOLICIAS  Primary key ,
	NOMPOL varchar (45) not NULL ,
	DIRPOL varchar(50) not null,
	NROPAT  char(4) NULL,
	ELIMINADO char(2) DEFAULT 'No' 
) 
GO

INSERT INTO POLICIAS VALUES ('P0001','Guzman Ochoa, Walther','Lima','003','No')
INSERT INTO POLICIAS VALUES ('P0002','Maldonado Huaman, Leoncio','Rimac','001','No')
INSERT INTO POLICIAS VALUES ('P0003','Gaspar Acosta, Manuel','Los Olivos','004','No')
INSERT INTO POLICIAS VALUES ('P0004','Echegaray Fernandez, Ricardo','Rimac','006','No')
INSERT INTO POLICIAS VALUES ('P0005','Cano Silva, Roberto','Rimac','004','No')
INSERT INTO POLICIAS VALUES ('P0006','Melgarejo Rojas, Julio','Los Olivos','001','No')
INSERT INTO POLICIAS VALUES ('P0007','Grijalva Diaz, Eduardo','Lima','005','No')
INSERT INTO POLICIAS VALUES ('P0008','Murillo Sanchez, Christian','Breña','003','No')
INSERT INTO POLICIAS VALUES ('P0009','Lopez Villar, Fernando','Lima','005','No')
go
INSERT INTO POLICIAS VALUES ('P0010','La Riva Suarez, Jorge','Breña','006','No')
INSERT INTO POLICIAS VALUES ('P0011','Muñante Robles, Miguel','Los Olivos','002','No')
INSERT INTO POLICIAS VALUES ('P0012','Camacho Gutierrez, Jose','San Martin de Porres','007','No')
INSERT INTO POLICIAS VALUES ('P0013','Gonzales La Torre, Julio','Breña','002','No')
INSERT INTO POLICIAS VALUES ('P0014','Roman Zavaleta, Franklin','San Martin de Porres','007','No')
GO

CREATE TABLE PAPELETAS(
	NROPAP    int NOT NULL CONSTRAINT PKPAPELETAS Primary Key ,
    NROPLA    char(6) REFERENCES VEHICULOS NOT NULL,
	CODINF    char(3) REFERENCES INFRACCIONES NOT NULL ,
	CODPOL    char(5) REFERENCES POLICIAS NOT NULL ,
	PAPFECHA  datetime NULL DEFAULT GETDATE(),
	PAGADO	  char(2) DEFAULT 'No',
	FECPAGO	  datetime NULL,
	ELIMINADO char(2) DEFAULT 'No' 
) 
go

INSERT INTO PAPELETAS VALUES (100001,'V00001','I08','P0004','10/03/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100002,'V00001','I07','P0001','15/03/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100003,'V00002','I06','P0004','28/03/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100004,'V00003','I04','P0005','29/05/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100005,'V00003','I04','P0004','01/06/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100006,'V00003','I05','P0006','12/06/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100007,'V00005','I04','P0005','23/06/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100008,'V00005','I04','P0001','14/07/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100009,'V00004','I08','P0004','25/07/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100010,'V00004','I04','P0004','27/07/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100011,'V00004','I04','P0005','31/07/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100012,'V00004','I07','P0004','02/08/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100013,'V00005','I08','P0005','08/08/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100014,'V00005','I04','P0009','24/08/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100015,'V00005','I01','P0006','25/08/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100016,'V00005','I07','P0006','08/09/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100017,'V00006','I05','P0006','16/09/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100018,'V00006','I05','P0001','07/10/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100019,'V00007','I05','P0004','11/10/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100020,'V00007','I05','P0001','10/11/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100021,'V00001','I05','P0004','22/11/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100022,'V00011','I07','P0001','25/11/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100023,'V00012','I08','P0004','08/12/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100024,'V00012','I05','P0005','14/12/2014','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100025,'V00012','I04','P0004','21/12/2014','No',NULL,'No')
go

INSERT INTO PAPELETAS VALUES (100026,'V00013','I05','P0006','12/01/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100027,'V00013','I05','P0005','23/01/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100028,'V00013','I04','P0001','28/01/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100029,'V00014','I07','P0007','05/02/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100030,'V00014','I04','P0004','08/02/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100031,'V00014','I04','P0005','16/02/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100032,'V00014','I07','P0004','02/03/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100033,'V00015','I04','P0005','09/03/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100034,'V00016','I04','P0004','24/03/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100035,'V00016','I01','P0006','28/03/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100036,'V00017','I05','P0007','08/04/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100037,'V00017','I05','P0006','16/04/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100038,'V00018','I04','P0001','24/04/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100039,'V00019','I04','P0004','27/04/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100040,'V00019','I01','P0001','02/05/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100041,'V00001','I05','P0004','10/05/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100042,'V00011','I07','P0001','25/05/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100043,'V00012','I08','P0008','04/06/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100044,'V00012','I05','P0005','19/06/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100045,'V00012','I04','P0004','23/06/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100046,'V00013','I05','P0006','10/07/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100047,'V00013','I05','P0005','23/07/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100048,'V00013','I04','P0001','30/07/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100049,'V00014','I07','P0004','05/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100050,'V00014','I04','P0004','25/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100051,'V00014','I04','P0005','04/09/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100052,'V00014','I07','P0004','22/09/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100053,'V00015','I04','P0005','30/09/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100054,'V00016','I04','P0004','04/10/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100055,'V00016','I01','P0009','15/10/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100056,'V00017','I05','P0006','28/10/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100057,'V00017','I05','P0008','06/11/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100058,'V00018','I04','P0001','27/11/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100059,'V00019','I04','P0004','11/12/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100060,'V00019','I01','P0001','22/12/2015','No',NULL,'No')
go

INSERT INTO PAPELETAS VALUES (100061,'V00020','I05','P0004','04/01/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100062,'V00020','I07','P0001','05/01/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100063,'V00021','I08','P0004','08/01/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100064,'V00021','I05','P0005','09/01/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100065,'V00022','I04','P0004','11/01/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100066,'V00022','I05','P0006','12/02/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100067,'V00023','I05','P0005','03/02/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100068,'V00023','I04','P0001','04/02/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100069,'V00024','I07','P0004','05/03/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100070,'V00024','I04','P0004','08/03/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100071,'V00025','I04','P0005','01/03/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100072,'V00025','I07','P0004','02/04/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100073,'V00026','I04','P0005','03/04/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100074,'V00026','I05','P0004','04/04/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100075,'V00027','I01','P0006','05/05/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100076,'V00027','I05','P0006','08/05/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100077,'V00028','I05','P0006','06/05/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100078,'V00028','I03','P0001','07/05/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100079,'V00029','I03','P0004','11/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100080,'V00029','I01','P0001','02/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100081,'V00030','I03','P0004','11/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100082,'V00030','I01','P0001','02/06/2016','No',NULL,'No')
GO

INSERT INTO PAPELETAS VALUES (100083,'V00003','I09','P0001','03/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100084,'V00001','I10','P0002','08/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100085,'V00004','I11','P0003','08/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100086,'V00007','I12','P0004','14/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100087,'V00005','I07','P0005','21/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100088,'V00015','I03','P0006','25/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100089,'V00008','I09','P0007','28/06/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100090,'V00006','I11','P0008','04/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100091,'V00017','I10','P0001','08/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100092,'V00002','I12','P0002','10/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100093,'V00008','I09','P0003','13/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100094,'V00018','I11','P0004','17/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100095,'V00009','I10','P0005','21/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100096,'V00019','I09','P0006','22/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100097,'V00020','I11','P0008','25/07/2016','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100098,'V00010','I12','P0007','30/07/2016','No',NULL,'No')
GO

SELECT * FROM PAPELETAS
go

INSERT INTO PAPELETAS VALUES (100099,'V00031','I01','P0007','30/07/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100100,'V00035','I02','P0008','31/07/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100101,'V00039','I03','P0001','01/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100102,'V00040','I04','P0009','02/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100103,'V00045','I05','P0004','04/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100104,'V00036','I06','P0010','06/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100105,'V00034','I07','P0004','10/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100106,'V00046','I08','P0011','10/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100107,'V00032','I09','P0004','12/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100108,'V00039','I10','P0011','14/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100109,'V00047','I11','P0009','15/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100110,'V00033','I12','P0006','16/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100111,'V00040','I05','P0012','16/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100112,'V00048','I04','P0005','18/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100113,'V00038','I03','P0012','18/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100114,'V00041','I02','P0007','20/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100115,'V00036','I01','P0014','20/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100116,'V00048','I12','P0005','21/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100117,'V00035','I11','P0014','22/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100118,'V00015','I10','P0013','24/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100119,'V00041','I09','P0012','24/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100120,'V00043','I08','P0010','26/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100121,'V00047','I07','P0011','28/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100122,'V00050','I06','P0013','28/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100123,'V00024','I12','P0005','29/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100124,'V00005','I11','P0014','29/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100125,'V00035','I10','P0013','31/08/2015','No',NULL,'No')
INSERT INTO PAPELETAS VALUES (100126,'V00047','I09','P0012','31/08/2015','No',NULL,'No')
GO

CREATE TABLE AUDITORIA_INFRACCIONES
(
	NROREG	int	identity(1000,1) CONSTRAINT PK_AUDIT_INFRACCIONES primary key ,
	CODINF  char (3) NOT NULL,
	DESINF  varchar (50) not NULL ,
	USUARIO	varchar(50) not null,
	FECHA	datetime not null,
	TIPO	varchar(20) not null
) 
GO

SELECT 'BASE DE DATOS BDTRANSITO2018 CREADA CORRECTAMENTE' AS Mensaje
GO

-- CREACION DE LOS PROCEDIMIENTOS ALMACENADOS

USE BDTRANSITO2018_LF
GO

-- Papeletas por Anio
CREATE OR ALTER PROCEDURE usp_papeletas_por_anio
  @anio_papeleta INT
AS
  SELECT P.NROPAP, P.PAPFECHA, PR.NOMPRO, V.NROPLA, I.CODINF
  FROM INFRACCIONES AS I
  INNER JOIN PAPELETAS AS P
    ON I.CODINF = P.CODINF
  INNER JOIN VEHICULOS AS V
    ON P.NROPLA = V.NROPLA
  INNER JOIN PROPIETARIOS AS PR
    ON V.DNIPRO = PR.DNIPRO
  WHERE YEAR(P.PAPFECHA) = @anio_papeleta
GO

EXECUTE usp_papeletas_por_anio 2016
GO

-- Lista de Policias
CREATE OR ALTER PROCEDURE usp_listar_policias
AS
  SELECT P.CODPOL, P.NOMPOL
  FROM POLICIAS AS P
GO

EXECUTE usp_listar_policias
GO

-- Papeletas por Policia y Anio
CREATE OR ALTER PROCEDURE usp_papeletas_por_policia_anio
  @codipol CHAR(5),
  @anio_papeleta INT
AS
  SELECT P.NROPAP, P.PAPFECHA, PR.NOMPRO, V.NROPLA, I.CODINF
  FROM INFRACCIONES AS I
  INNER JOIN PAPELETAS AS P
    ON I.CODINF = P.CODINF
  INNER JOIN VEHICULOS AS V
    ON P.NROPLA = V.NROPLA
  INNER JOIN PROPIETARIOS AS PR
    ON V.DNIPRO = PR.DNIPRO
  WHERE  P.CODPOL = @codipol AND YEAR(P.PAPFECHA) = @anio_papeleta
GO

EXECUTE usp_papeletas_por_policia_anio 'P0001', 2016
GO
